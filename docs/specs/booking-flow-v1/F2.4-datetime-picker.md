# F2.4: Date & Time Picker

## Feature Specification

**Feature ID:** F2.4
**Feature Name:** Date & Time Picker
**Milestone:** 2 - Customer Can Book
**Priority:** High
**Status:** Planned
**Depends On:** F2.3

---

## User Story

> As a customer, I want to select a date and time for my appointment so that I can schedule the service at a convenient time.

---

## Acceptance Criteria

1. Calendar displays available dates (next 30 days)
2. Unavailable dates are disabled (past dates, fully booked)
3. Time slots shown for selected date
4. Time slots show availability status
5. Single time slot selection
6. Selected date/time displayed in summary
7. "Continue" navigates to location selection (F2.5)

---

## Technical Specification

### Availability Logic (MVP - Mock)

For MVP, all future time slots are available:
```typescript
// Mock availability - all slots available
function generateTimeSlots(date: Date, durationMin: number): TimeSlot[] {
  const slots: TimeSlot[] = [];
  const startHour = 8; // 8 AM
  const endHour = 18;  // 6 PM

  for (let hour = startHour; hour < endHour; hour++) {
    for (let minute = 0; minute < 60; minute += 30) {
      // Skip if slot end would exceed end hour
      const slotEnd = new Date(date);
      slotEnd.setHours(hour, minute + durationMin);
      if (slotEnd.getHours() > endHour) continue;

      slots.push({
        time: `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`,
        available: true,
      });
    }
  }
  return slots;
}
```

### Future: Real Availability API
```
GET /api/stylists/:id/availability?date=2025-01-15
```

---

### Files to Create

| File | Purpose |
|------|---------|
| `apps/web/components/booking/datetime-picker.tsx` | Date/time selection step |
| `apps/web/components/ui/calendar.tsx` | Reusable calendar component |

---

### Component: DateTimePicker

```tsx
interface DateTimePickerProps {
  serviceDurationMin: number;
  selectedDate: Date | null;
  selectedTime: string | null;
  onDateSelect: (date: Date) => void;
  onTimeSelect: (time: string) => void;
  onContinue: () => void;
  onBack: () => void;
}

interface TimeSlot {
  time: string;      // "09:00", "09:30", etc.
  available: boolean;
}
```

**Layout:**
```
+----------------------------------+
| [<] Back                         |
| Select Date & Time               |
+----------------------------------+
|  < December 2025 >               |
| Mo Tu We Th Fr Sa Su             |
|  1  2  3  4  5  6  7             |
|  8  9 10 11 12 13 14             |
| 15 16 17 18 19 20 21             |
| 22 23 24 25 26 27 28             |
| 29 30 31                         |
+----------------------------------+
| Available Times (2h 30min slots) |
+----------------------------------+
| 08:00 | 08:30 | 09:00 | 09:30   |
| 10:00 | 10:30 | 11:00 | 11:30   |
| 12:00 | 12:30 | 13:00 | 13:30   |
| 14:00 | 14:30 | 15:00 |         |
+----------------------------------+
|                                  |
| Selected: Jan 15, 2025 at 10:00  |
|                                  |
| [       Continue       ]         |
+----------------------------------+
```

---

### Component: Calendar

Simple month view calendar:

```tsx
interface CalendarProps {
  selectedDate: Date | null;
  onDateSelect: (date: Date) => void;
  minDate?: Date;
  maxDate?: Date;
  disabledDates?: Date[];
}
```

**Features:**
- Month navigation (prev/next)
- Current day highlighted
- Selected date highlighted
- Past dates disabled
- Weekend styling (optional)

---

### Time Slot Grid

```tsx
interface TimeSlotGridProps {
  slots: TimeSlot[];
  selectedTime: string | null;
  onTimeSelect: (time: string) => void;
}
```

**Slot States:**
- Available: Clickable, default styling
- Unavailable: Disabled, muted
- Selected: Primary background

---

## UI/UX Requirements

### Visual Design
- Calendar: Clean grid, brand accent for selection
- Time slots: Button-like grid, 4 columns
- Past dates: Greyed out, not clickable
- Selected: Primary color highlight

### States
- **No date selected:** Time slots hidden
- **Date selected:** Time slots for that date shown
- **Time selected:** Full datetime displayed, Continue enabled
- **Past time today:** Disabled even if today is selected

### Interactions
- Click date: Selects date, shows time slots
- Click time: Selects time
- Month nav: Changes visible month
- Continue: Disabled until both date and time selected

---

## Date/Time Formatting

```typescript
// Format for display
function formatDate(date: Date): string {
  return date.toLocaleDateString('en-ZA', {
    weekday: 'short',
    day: 'numeric',
    month: 'short',
    year: 'numeric'
  });
  // "Mon, 15 Jan 2025"
}

function formatTime(time: string): string {
  const [hours, minutes] = time.split(':');
  const hour = parseInt(hours, 10);
  const period = hour >= 12 ? 'PM' : 'AM';
  const displayHour = hour > 12 ? hour - 12 : hour === 0 ? 12 : hour;
  return `${displayHour}:${minutes} ${period}`;
  // "10:00 AM"
}

// Combine for full datetime
function formatDateTime(date: Date, time: string): string {
  return `${formatDate(date)} at ${formatTime(time)}`;
  // "Mon, 15 Jan 2025 at 10:00 AM"
}
```

---

## Tasks Breakdown

| Task | Effort | Priority |
|------|--------|----------|
| Create `Calendar` component | 1h | P0 |
| Create `TimeSlotGrid` component | 30min | P0 |
| Create `DateTimePicker` step | 45min | P0 |
| Implement mock availability | 20min | P0 |
| Add date/time formatters | 15min | P0 |
| Style calendar states | 30min | P1 |
| Add month navigation | 20min | P1 |
| Past date/time disabling | 20min | P1 |
| Connect to booking flow | 15min | P0 |

**Total Estimated Time:** ~4.5 hours

---

## Verification Checklist

- [ ] Calendar renders current month
- [ ] Month navigation works
- [ ] Past dates disabled
- [ ] Date selection works
- [ ] Time slots appear on date select
- [ ] Time slot selection works
- [ ] Selected date/time displayed
- [ ] Continue disabled without selection
- [ ] Continue navigates to location step
- [ ] Back navigates to service step
- [ ] Today's past times disabled
- [ ] 30-day limit enforced
- [ ] Mobile responsive
